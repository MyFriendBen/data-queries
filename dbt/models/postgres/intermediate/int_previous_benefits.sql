{{ config(
    materialized='view',
    description='Base table for final previous benefits data query'
) }}


SELECT
    white_label_id,
    partner,
    sum(CASE WHEN has_acp = true THEN 1 ELSE 0 END) AS acp,
    sum(CASE WHEN has_andcs = true THEN 1 ELSE 0 END) AS andcs,
    sum(CASE WHEN has_ccb = true THEN 1 ELSE 0 END) AS ccb,
    sum(CASE WHEN has_ccap = true THEN 1 ELSE 0 END) AS ccap,
    sum(CASE WHEN has_ccdf = true THEN 1 ELSE 0 END) AS ccdf,
    sum(CASE WHEN has_cdhcs = true THEN 1 ELSE 0 END) AS cdhcs,
    sum(CASE WHEN has_chp = true THEN 1 ELSE 0 END) AS chp,
    sum(CASE WHEN has_chs = true THEN 1 ELSE 0 END) AS chs,
    sum(CASE WHEN has_co_andso = true THEN 1 ELSE 0 END) AS co_andso,
    sum(CASE WHEN has_coctc = true THEN 1 ELSE 0 END) AS coctc,
    sum(CASE WHEN has_coeitc = true THEN 1 ELSE 0 END) AS coeitc,
    sum(CASE WHEN has_cowap = true THEN 1 ELSE 0 END) AS cowap,
    sum(CASE WHEN has_cpcr = true THEN 1 ELSE 0 END) AS cpcr,
    sum(CASE WHEN has_csfp = true THEN 1 ELSE 0 END) AS csfp,
    sum(CASE WHEN has_ctc = true THEN 1 ELSE 0 END) AS ctc,
    sum(CASE WHEN has_dpp = true THEN 1 ELSE 0 END) AS dpp,
    sum(CASE WHEN has_ede = true THEN 1 ELSE 0 END) AS ede,
    sum(CASE WHEN has_eitc = true THEN 1 ELSE 0 END) AS eitc,
    sum(CASE WHEN has_erc = true THEN 1 ELSE 0 END) AS erc,
    sum(CASE WHEN has_fatc = true THEN 1 ELSE 0 END) AS fatc,
    sum(CASE WHEN has_leap = true THEN 1 ELSE 0 END) AS leap,
    sum(CASE WHEN has_lifeline = true THEN 1 ELSE 0 END) AS lifeline,
    sum(CASE WHEN has_ma_eaedc = true THEN 1 ELSE 0 END) AS ma_eaedc,
    sum(CASE WHEN has_ma_macfc = true THEN 1 ELSE 0 END) AS ma_macfc,
    sum(CASE WHEN has_ma_maeitc = true THEN 1 ELSE 0 END) AS ma_maeitc,
    sum(CASE WHEN has_ma_mbta = true THEN 1 ELSE 0 END) AS ma_mbta,
    sum(CASE WHEN has_ma_ssp = true THEN 1 ELSE 0 END) AS ma_ssp,
    sum(CASE WHEN has_medicaid = true THEN 1 ELSE 0 END) AS medicaid,
    sum(CASE WHEN has_mydenver = true THEN 1 ELSE 0 END) AS mydenver,
    sum(CASE WHEN has_nc_lieap = true THEN 1 ELSE 0 END) AS nc_lieap,
    sum(CASE WHEN has_nccip = true THEN 1 ELSE 0 END) AS nccip,
    sum(CASE WHEN has_ncscca = true THEN 1 ELSE 0 END) AS ncscca,
    sum(CASE WHEN has_ncwap = true THEN 1 ELSE 0 END) AS ncwap,
    sum(CASE WHEN has_nfp = true THEN 1 ELSE 0 END) AS nfp,
    sum(CASE WHEN has_nslp = true THEN 1 ELSE 0 END) AS nslp,
    sum(CASE WHEN has_oap = true THEN 1 ELSE 0 END) AS oap,
    sum(CASE WHEN has_pell_grant = true THEN 1 ELSE 0 END) AS pell_grant,
    sum(CASE WHEN has_rag = true THEN 1 ELSE 0 END) AS rag,
    sum(CASE WHEN has_rtdlive = true THEN 1 ELSE 0 END) AS rtdlive,
    sum(CASE WHEN has_section_8 = true THEN 1 ELSE 0 END) AS section_8,
    sum(CASE WHEN has_snap = true THEN 1 ELSE 0 END) AS snap,
    sum(CASE WHEN has_ssi = true THEN 1 ELSE 0 END) AS ssi,
    sum(CASE WHEN has_sunbucks = true THEN 1 ELSE 0 END) AS sunbucks,
    sum(CASE WHEN has_tanf = true THEN 1 ELSE 0 END) AS tanf,
    sum(CASE WHEN has_ubp = true THEN 1 ELSE 0 END) AS ubp,
    sum(CASE WHEN has_upk = true THEN 1 ELSE 0 END) AS upk,
    sum(CASE WHEN has_va = true THEN 1 ELSE 0 END) AS va,
    sum(CASE WHEN has_wic = true THEN 1 ELSE 0 END) AS wic
FROM {{ ref('int_complete_screener_data') }}
GROUP BY white_label_id, partner
