{{ config(
    materialized='view',
    description='Intermediate model aggregating current benefits counts by white_label_id and partner'
) }}

SELECT
    white_label_id,
    partner,
    sum(CASE WHEN acp_annual > 0 THEN 1 ELSE 0 END) AS acp,
    sum(CASE WHEN andcs_annual > 0 THEN 1 ELSE 0 END) AS andcs,
    sum(CASE WHEN awd_medicaid_annual > 0 THEN 1 ELSE 0 END) AS awd_medicaid,
    sum(CASE WHEN bca_annual > 0 THEN 1 ELSE 0 END) AS bca,
    sum(CASE WHEN ccap_annual > 0 THEN 1 ELSE 0 END) AS ccap,
    sum(CASE WHEN cdhcs_annual > 0 THEN 1 ELSE 0 END) AS cdhcs,
    sum(CASE WHEN cfhc_annual > 0 THEN 1 ELSE 0 END) AS cfhc,
    sum(CASE WHEN chp_annual > 0 THEN 1 ELSE 0 END) AS chp,
    sum(CASE WHEN chs_annual > 0 THEN 1 ELSE 0 END) AS chs,
    sum(CASE WHEN cocb_annual > 0 THEN 1 ELSE 0 END) AS cocb,
    sum(CASE WHEN coctc_annual > 0 THEN 1 ELSE 0 END) AS coctc,
    sum(CASE WHEN coeitc_annual > 0 THEN 1 ELSE 0 END) AS coeitc,
    sum(CASE WHEN co_energy_calculator_bheap_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_bheap,
    sum(CASE WHEN co_energy_calculator_bhgap_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_bhgap,
    sum(CASE WHEN co_energy_calculator_care_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_care,
    sum(CASE WHEN co_energy_calculator_cngba_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_cngba,
    sum(CASE WHEN co_energy_calculator_cpcr_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_cpcr,
    sum(CASE WHEN co_energy_calculator_ea_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_ea,
    sum(CASE WHEN co_energy_calculator_energy_ebt_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_ebt,
    sum(CASE WHEN co_energy_calculator_eoc_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_eoc,
    sum(CASE WHEN co_energy_calculator_eoccip_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_eoccip,
    sum(CASE WHEN co_energy_calculator_eocs_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_eocs,
    sum(CASE WHEN co_energy_calculator_leap_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_leap,
    sum(CASE WHEN co_energy_calculator_poipp_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_poipp,
    sum(CASE WHEN co_energy_calculator_ubp_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_ubp,
    sum(CASE WHEN co_energy_calculator_xceleap_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_xceleap,
    sum(CASE WHEN co_energy_calculator_xcelgap_annual > 0 THEN 1 ELSE 0 END) AS co_energy_calculator_xcelgap,
    sum(CASE WHEN co_medicaid_annual > 0 THEN 1 ELSE 0 END) AS co_medicaid,
    sum(CASE WHEN co_snap_annual > 0 THEN 1 ELSE 0 END) AS co_snap,
    sum(CASE WHEN co_tanf_annual > 0 THEN 1 ELSE 0 END) AS co_tanf,
    sum(CASE WHEN co_wic_annual > 0 THEN 1 ELSE 0 END) AS co_wic,
    sum(CASE WHEN cowap_annual > 0 THEN 1 ELSE 0 END) AS cowap,
    sum(CASE WHEN cpcr_annual > 0 THEN 1 ELSE 0 END) AS cpcr,
    sum(CASE WHEN ctc_annual > 0 THEN 1 ELSE 0 END) AS ctc,
    sum(CASE WHEN cwd_medicaid_annual > 0 THEN 1 ELSE 0 END) AS cwd_medicaid,
    sum(CASE WHEN dpp_annual > 0 THEN 1 ELSE 0 END) AS dpp,
    sum(CASE WHEN dptr_annual > 0 THEN 1 ELSE 0 END) AS dptr,
    sum(CASE WHEN dsr_annual > 0 THEN 1 ELSE 0 END) AS dsr,
    sum(CASE WHEN dtr_annual > 0 THEN 1 ELSE 0 END) AS dtr,
    sum(CASE WHEN ede_annual > 0 THEN 1 ELSE 0 END) AS ede,
    sum(CASE WHEN eitc_annual > 0 THEN 1 ELSE 0 END) AS eitc,
    sum(CASE WHEN emergency_medicaid_annual > 0 THEN 1 ELSE 0 END) AS emergency_medicaid,
    sum(CASE WHEN erap_annual > 0 THEN 1 ELSE 0 END) AS erap,
    sum(CASE WHEN erc_annual > 0 THEN 1 ELSE 0 END) AS erc,
    sum(CASE WHEN fatc_annual > 0 THEN 1 ELSE 0 END) AS fatc,
    sum(CASE WHEN fps_annual > 0 THEN 1 ELSE 0 END) AS fps,
    sum(CASE WHEN leap_annual > 0 THEN 1 ELSE 0 END) AS leap,
    sum(CASE WHEN lifeline_annual > 0 THEN 1 ELSE 0 END) AS lifeline,
    sum(CASE WHEN lwcr_annual > 0 THEN 1 ELSE 0 END) AS lwcr,
    sum(CASE WHEN ma_aca_annual > 0 THEN 1 ELSE 0 END) AS ma_aca,
    sum(CASE WHEN ma_ccdf_annual > 0 THEN 1 ELSE 0 END) AS ma_ccdf,
    sum(CASE WHEN ma_cfc_annual > 0 THEN 1 ELSE 0 END) AS ma_cfc,
    sum(CASE WHEN ma_eaedc_annual > 0 THEN 1 ELSE 0 END) AS ma_eaedc,
    sum(CASE WHEN ma_maeitc_annual > 0 THEN 1 ELSE 0 END) AS ma_maeitc,
    sum(CASE WHEN ma_mass_health_annual > 0 THEN 1 ELSE 0 END) AS ma_mass_health,
    sum(CASE WHEN ma_mass_health_limited_annual > 0 THEN 1 ELSE 0 END) AS ma_mass_health_limited,
    sum(CASE WHEN ma_mbta_annual > 0 THEN 1 ELSE 0 END) AS ma_mbta,
    sum(CASE WHEN ma_snap_annual > 0 THEN 1 ELSE 0 END) AS ma_snap,
    sum(CASE WHEN ma_ssp_annual > 0 THEN 1 ELSE 0 END) AS ma_ssp,
    sum(CASE WHEN ma_tafdc_annual > 0 THEN 1 ELSE 0 END) AS ma_tafdc,
    sum(CASE WHEN ma_wic_annual > 0 THEN 1 ELSE 0 END) AS ma_wic,
    sum(CASE WHEN medicaid_annual > 0 THEN 1 ELSE 0 END) AS medicaid,
    sum(CASE WHEN medicare_savings_annual > 0 THEN 1 ELSE 0 END) AS medicare_savings,
    sum(CASE WHEN mydenver_annual > 0 THEN 1 ELSE 0 END) AS mydenver,
    sum(CASE WHEN myspark_annual > 0 THEN 1 ELSE 0 END) AS myspark,
    sum(CASE WHEN nc_aca_annual > 0 THEN 1 ELSE 0 END) AS nc_aca,
    sum(CASE WHEN nccip_annual > 0 THEN 1 ELSE 0 END) AS nccip,
    sum(CASE WHEN nc_emergency_medicaid_annual > 0 THEN 1 ELSE 0 END) AS nc_emergency_medicaid,
    sum(CASE WHEN nc_lieap_annual > 0 THEN 1 ELSE 0 END) AS nc_lieap,
    sum(CASE WHEN nc_medicaid_annual > 0 THEN 1 ELSE 0 END) AS nc_medicaid,
    sum(CASE WHEN nc_scca_annual > 0 THEN 1 ELSE 0 END) AS nc_scca,
    sum(CASE WHEN nc_snap_annual > 0 THEN 1 ELSE 0 END) AS nc_snap,
    sum(CASE WHEN nc_tanf_annual > 0 THEN 1 ELSE 0 END) AS nc_tanf,
    sum(CASE WHEN ncwap_annual > 0 THEN 1 ELSE 0 END) AS nc_wap,
    sum(CASE WHEN nc_wic_annual > 0 THEN 1 ELSE 0 END) AS nc_wic,
    sum(CASE WHEN il_aabd_annual > 0 THEN 1 ELSE 0 END) AS il_aabd,
    sum(CASE WHEN il_aca_annual > 0 THEN 1 ELSE 0 END) AS il_aca,
    sum(CASE WHEN il_aca_adults_annual > 0 THEN 1 ELSE 0 END) AS il_aca_adults,
    sum(CASE WHEN il_all_kids_annual > 0 THEN 1 ELSE 0 END) AS il_all_kids,
    sum(CASE WHEN il_bap_annual > 0 THEN 1 ELSE 0 END) AS il_bap,
    sum(CASE WHEN il_ctc_annual > 0 THEN 1 ELSE 0 END) AS il_ctc,
    sum(CASE WHEN il_eitc_annual > 0 THEN 1 ELSE 0 END) AS il_eitc,
    sum(CASE WHEN il_family_care_annual > 0 THEN 1 ELSE 0 END) AS il_family_care,
    sum(CASE WHEN il_liheap_annual > 0 THEN 1 ELSE 0 END) AS il_liheap,
    sum(CASE WHEN il_medicaid_annual > 0 THEN 1 ELSE 0 END) AS il_medicaid,
    sum(CASE WHEN il_moms_and_babies_annual > 0 THEN 1 ELSE 0 END) AS il_moms_and_babies,
    sum(CASE WHEN il_nslp_annual > 0 THEN 1 ELSE 0 END) AS il_nslp,
    sum(CASE WHEN il_snap_annual > 0 THEN 1 ELSE 0 END) AS il_snap,
    sum(CASE WHEN il_tanf_annual > 0 THEN 1 ELSE 0 END) AS il_tanf,
    sum(CASE WHEN il_transit_reduced_fare_annual > 0 THEN 1 ELSE 0 END) AS il_transit_reduced_fare,
    sum(CASE WHEN il_wic_annual > 0 THEN 1 ELSE 0 END) AS il_wic,
    sum(CASE WHEN nf_annual > 0 THEN 1 ELSE 0 END) AS nf,
    sum(CASE WHEN nfp_annual > 0 THEN 1 ELSE 0 END) AS nfp,
    sum(CASE WHEN nslp_annual > 0 THEN 1 ELSE 0 END) AS nslp,
    sum(CASE WHEN oap_annual > 0 THEN 1 ELSE 0 END) AS oap,
    sum(CASE WHEN omnisalud_annual > 0 THEN 1 ELSE 0 END) AS omnisalud,
    sum(CASE WHEN pell_grant_annual > 0 THEN 1 ELSE 0 END) AS pell_grant,
    sum(CASE WHEN rag_annual > 0 THEN 1 ELSE 0 END) AS rag,
    sum(CASE WHEN rhc_annual > 0 THEN 1 ELSE 0 END) AS rhc,
    sum(CASE WHEN rtdlive_annual > 0 THEN 1 ELSE 0 END) AS rtdlive,
    sum(CASE WHEN shitc_annual > 0 THEN 1 ELSE 0 END) AS shitc,
    sum(CASE WHEN sunbucks_annual > 0 THEN 1 ELSE 0 END) AS sunbucks,
    sum(CASE WHEN snap_annual > 0 THEN 1 ELSE 0 END) AS snap,
    sum(CASE WHEN ssdi_annual > 0 THEN 1 ELSE 0 END) AS ssdi,
    sum(CASE WHEN ssi_annual > 0 THEN 1 ELSE 0 END) AS ssi,
    sum(CASE WHEN tabor_annual > 0 THEN 1 ELSE 0 END) AS tabor,
    sum(CASE WHEN tanf_annual > 0 THEN 1 ELSE 0 END) AS tanf,
    sum(CASE WHEN trua_annual > 0 THEN 1 ELSE 0 END) AS trua,
    sum(CASE WHEN ubp_annual > 0 THEN 1 ELSE 0 END) AS ubp,
    sum(CASE WHEN wic_annual > 0 THEN 1 ELSE 0 END) AS wic
FROM {{ ref('int_complete_screener_data') }}
GROUP BY white_label_id, partner
